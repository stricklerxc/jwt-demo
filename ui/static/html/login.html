<!DOCTYPE html>
<html lang="en">
    <head>
        <!-- Required meta tags for Bootstrap -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!-- Bootstrap -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">

        <!-- JQuery -->
        <script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>

        <!-- Custom stylesheets -->
        <link href="css/login.css" rel="stylesheet">

        <title>Welcome!</title>
    </head>

    <body class="text-center">
        <main class="form-signin">
            <form id=signin-form action="/auth" method="POST">
                <h1 class="h3 mb-3 fw-normal">Login</h1>

                <div class="form-floating">
                    <input name="username" type="text" class="form-control" id="floatingInput" placeholder="username">
                    <label for="floatingInput">Username</label>
                </div>
                <div class="form-floating">
                    <input name="password" type="password" class="form-control" id="floatingPassword" placeholder="password">
                    <label for="floatingPassword">Password</label>
                </div>

                <div class="checkbox mb-3">
                    <label>
                        <input type="checkbox" value="remember-me"> Remember me
                    </label>
                </div>
                <button class="w-100 btn btn-lg btn-primary" type="submit">Sign in</button>
                <div id=login-status></div>
                <script>
                    $("#signin-form").submit(function(event) {
                        // event.stopPropagation();
                        event.preventDefault();
                        $.ajax({
                            url: $(this).attr("action"),
                            type: 'POST',
                            data: $(this).serialize(),
                            dataType: 'json',
                            success: function(data) {
                                window.location.href = "/hello"
                            },
                            error: function(data) {
                                $("#login-status").empty().append("<p style='color:red'> Login Failed. Please try again. </p>");
                            }
                        })
                    })
                </script>

                <p class="text-center">Don't have an account? <a href="/register">Register</a> </p>
            </form>
        </main>
    </body>
</html>
